{
  "timestamp": "2025-08-29T13:39:25.273Z",
  "environment": "development",
  "criticalVulnerabilities": {
    "environmentFileSecurity": {
      "score": 3.333333333333333,
      "tests": [
        {
          "passed": true,
          "test": "GitIgnore Environment Configuration",
          "vulnerability": "NONE",
          "details": {
            "missingPatterns": [],
            "hasWildcardPattern": true,
            "patternsFound": 6
          }
        },
        {
          "passed": false,
          "test": "Environment File Git Tracking",
          "vulnerability": "CRITICAL",
          "details": {
            "trackedFiles": [
              ".env.example"
            ],
            "message": "Environment files are being tracked in git!"
          }
        },
        {
          "passed": false,
          "test": "Environment File Exposure",
          "vulnerability": "CRITICAL",
          "details": {
            "exposedFiles": [
              ".env.local",
              ".env.production"
            ],
            "filesWithSecrets": [
              ".env.production"
            ],
            "recommendation": "Remove exposed environment files from working directory"
          }
        }
      ],
      "status": "VULNERABLE"
    },
    "apiKeySecurity": {
      "score": 3.333333333333333,
      "tests": [
        {
          "passed": false,
          "test": "Hardcoded Secret Removal",
          "vulnerability": "CRITICAL",
          "details": {
            "secretsFound": 1,
            "findings": [
              {
                "file": "pages/api/create-checkout-session.js",
                "type": "Mock Key Fallback",
                "severity": "HIGH"
              }
            ],
            "filesScanned": 4
          }
        },
        {
          "passed": true,
          "test": "Secret Key Access Control",
          "vulnerability": "NONE",
          "details": {
            "violations": [],
            "clientFilesScanned": 35,
            "serverOnlyPatterns": [
              "STRIPE_SECRET_KEY",
              "STRIPE_WEBHOOK_SECRET",
              "process.env.STRIPE_SECRET"
            ]
          }
        },
        {
          "passed": false,
          "test": "Fallback Key Removal",
          "vulnerability": "HIGH",
          "details": {
            "fallbacksFound": 1,
            "findings": [
              {
                "file": "pages/api/create-checkout-session.js",
                "pattern": "sk_test_mock_key_for_testing",
                "severity": "HIGH"
              }
            ],
            "filesScanned": 2
          }
        }
      ],
      "status": "VULNERABLE"
    },
    "corsConfiguration": {
      "score": 10,
      "test": {
        "passed": true,
        "test": "CORS Restriction",
        "vulnerability": "NONE",
        "details": {
          "hasWildcardCors": false,
          "hasEnvironmentCors": true,
          "hasSpecificDomains": true,
          "recommendation": "CORS properly restricted"
        }
      },
      "status": "SECURE"
    },
    "deploymentConflicts": {
      "score": 5,
      "tests": [
        {
          "passed": false,
          "test": "Vercel Artifact Removal",
          "vulnerability": "MEDIUM",
          "details": {
            "artifactsFound": [
              ".vercel/",
              ".vercel"
            ],
            "recommendation": "Remove Vercel artifacts to prevent deployment conflicts"
          }
        },
        {
          "passed": true,
          "test": "Deployment Configuration",
          "vulnerability": "NONE",
          "details": {
            "issues": [],
            "filesChecked": 2
          }
        }
      ],
      "status": "VULNERABLE"
    },
    "informationLeakage": {
      "score": 6.666666666666666,
      "tests": [
        {
          "passed": false,
          "test": "API Response Security",
          "vulnerability": "CRITICAL",
          "details": {
            "leakageFound": 1,
            "findings": [
              {
                "endpoint": "/api/health",
                "pattern": "key",
                "severity": "MEDIUM"
              }
            ],
            "endpointsTested": 2
          }
        },
        {
          "passed": true,
          "test": "Error Message Security",
          "vulnerability": "NONE",
          "details": {
            "issuesFound": 0,
            "issues": [],
            "recommendation": "Sanitize error messages before sending to client"
          }
        },
        {
          "passed": true,
          "test": "Logging Security",
          "vulnerability": "NONE",
          "details": {
            "hasProductionLogging": true,
            "hasSanitization": true,
            "hasSecretFiltering": false,
            "recommendation": "Logging security appears adequate"
          }
        }
      ],
      "status": "VULNERABLE"
    },
    "accessControl": {
      "score": 6.666666666666666,
      "tests": [
        {
          "passed": true,
          "test": "API Route Protection",
          "vulnerability": "NONE",
          "details": {
            "routesAnalyzed": 2,
            "averageScore": 1,
            "analysis": [
              {
                "route": "pages/api/create-checkout-session.js",
                "hasMethodChecking": true,
                "hasInputValidation": true,
                "hasErrorHandling": true,
                "score": 3
              },
              {
                "route": "pages/api/webhooks/stripe.js",
                "hasMethodChecking": true,
                "hasInputValidation": true,
                "hasErrorHandling": true,
                "score": 3
              }
            ]
          }
        },
        {
          "passed": false,
          "test": "HTTP Method Validation",
          "vulnerability": "MEDIUM",
          "details": {
            "testsRun": 3,
            "properlyHandled": 0,
            "results": [
              {
                "path": "/api/create-checkout-session",
                "method": "GET",
                "status": 200,
                "properlyHandled": false,
                "expected": "rejection"
              },
              {
                "path": "/api/webhooks/stripe",
                "method": "GET",
                "status": 200,
                "properlyHandled": false,
                "expected": "rejection"
              },
              {
                "path": "/api/health",
                "method": "POST",
                "status": 404,
                "properlyHandled": false,
                "expected": "acceptance"
              }
            ]
          }
        },
        {
          "passed": true,
          "test": "Input Validation",
          "vulnerability": "NONE",
          "details": {
            "testsRun": 2,
            "safelyHandled": 2,
            "results": [
              {
                "endpoint": "/api/create-checkout-session",
                "inputType": "maliciousScript",
                "status": 404,
                "inputReflected": false,
                "safelyHandled": true
              },
              {
                "endpoint": "/api/create-checkout-session",
                "inputType": "sqlInjection",
                "status": 404,
                "inputReflected": false,
                "safelyHandled": true
              }
            ]
          }
        }
      ],
      "status": "VULNERABLE"
    }
  },
  "securityScore": 5.833333333333332,
  "vulnerabilitiesFound": [
    {
      "test": "Environment File Git Tracking",
      "vulnerability": "CRITICAL",
      "issue": "Security test failed"
    },
    {
      "test": "Environment File Exposure",
      "vulnerability": "CRITICAL",
      "issue": "Security test failed"
    },
    {
      "test": "Hardcoded Secret Removal",
      "vulnerability": "CRITICAL",
      "issue": "Security test failed"
    },
    {
      "test": "Fallback Key Removal",
      "vulnerability": "HIGH",
      "issue": "Security test failed"
    },
    {
      "test": "Vercel Artifact Removal",
      "vulnerability": "MEDIUM",
      "issue": "Security test failed"
    },
    {
      "test": "API Response Security",
      "vulnerability": "CRITICAL",
      "issue": "Security test failed"
    },
    {
      "test": "HTTP Method Validation",
      "vulnerability": "MEDIUM",
      "issue": "Security test failed"
    }
  ],
  "vulnerabilitiesFixed": [
    {
      "test": "GitIgnore Environment Configuration",
      "description": "Security vulnerability successfully resolved"
    },
    {
      "test": "Secret Key Access Control",
      "description": "Security vulnerability successfully resolved"
    },
    {
      "test": "CORS Restriction",
      "description": "Security vulnerability successfully resolved"
    },
    {
      "test": "Deployment Configuration",
      "description": "Security vulnerability successfully resolved"
    },
    {
      "test": "Error Message Security",
      "description": "Security vulnerability successfully resolved"
    },
    {
      "test": "Logging Security",
      "description": "Security vulnerability successfully resolved"
    },
    {
      "test": "API Route Protection",
      "description": "Security vulnerability successfully resolved"
    },
    {
      "test": "Input Validation",
      "description": "Security vulnerability successfully resolved"
    }
  ],
  "recommendations": []
}